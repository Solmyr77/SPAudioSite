import{a as c}from"./axios-Bo0ATomq.js";import{o as a,c as o,a as i,b as h,u as g,F as f,g as v,t as u}from"./index-BWouNbzn.js";function b(t,e){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[i("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm4.28 10.28a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 1 0-1.06 1.06l1.72 1.72H8.25a.75.75 0 0 0 0 1.5h5.69l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3Z","clip-rule":"evenodd"})])}function k(t,e){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[i("path",{d:"M7.493 18.5c-.425 0-.82-.236-.975-.632A7.48 7.48 0 0 1 6 15.125c0-1.75.599-3.358 1.602-4.634.151-.192.373-.309.6-.397.473-.183.89-.514 1.212-.924a9.042 9.042 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75A.75.75 0 0 1 15 2a2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H14.23c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23h-.777ZM2.331 10.727a11.969 11.969 0 0 0-.831 4.398 12 12 0 0 0 .52 3.507C2.28 19.482 3.105 20 3.994 20H4.9c.445 0 .72-.498.523-.898a8.963 8.963 0 0 1-.924-3.977c0-1.708.476-3.305 1.302-4.666.245-.403-.028-.959-.5-.959H4.25c-.832 0-1.612.453-1.918 1.227Z"})])}let r;const D=new Uint8Array(16);function $(){if(!r&&(r=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(D)}const s=[];for(let t=0;t<256;++t)s.push((t+256).toString(16).slice(1));function H(t,e=0){return s[t[e+0]]+s[t[e+1]]+s[t[e+2]]+s[t[e+3]]+"-"+s[t[e+4]]+s[t[e+5]]+"-"+s[t[e+6]]+s[t[e+7]]+"-"+s[t[e+8]]+s[t[e+9]]+"-"+s[t[e+10]]+s[t[e+11]]+s[t[e+12]]+s[t[e+13]]+s[t[e+14]]+s[t[e+15]]}const U=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),m={randomUUID:U};function S(t,e,l){if(m.randomUUID&&!e&&!t)return m.randomUUID();t=t||{};const n=t.random||(t.rng||$)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){l=l||0;for(let d=0;d<16;++d)e[l+d]=n[d];return e}return H(n)}const I={class:"flex flex-col items-center w-vw-full min-h-screen bg-ui-background"},R={ref:"titleHeader",class:"flex w-full justify-center items-center bg-ui-background pt-4"},j=i("h1",{class:"text-white dm-sans-bold text-2xl brightness-100"},"Zenekérés",-1),L=[j],V={ref:"inputHeader",class:"flex max-w-7xl w-11/12 justify-center items-center pb-12 pt-6"},E={ref:"songInput",placeholder:"Zene cím vagy link",class:"flex justify-center items-center dm-sans-regular rounded-tl-lg rounded-bl-lg ring-ui-ring ring-1 bg-ui-card text-gray-300 basis-5/6 py-4 px-4 text-xl",type:"text"},q={ref:"sendButton",class:"flex justify-center items-center basis-1/6 bg-ui-stone ring-1 ring-ui-ring py-4 rounded-tr-lg rounded-br-lg"},A={ref:"songsList",class:"flex flex-col max-w-7xl w-full items-center pb-4 overflow-auto pt-2"},B={class:"flex justify-center h-28 items-center w-11/12 mb-4"},C={class:"flex flex-col justify-between items-start w-full h-full basis-4/5 ring-ui-ring bg-ui-card rounded-tl-md rounded-bl-md ring-2 pl-3 py-3"},O={class:"flex justify-center items-center"},P={class:"text-gray-300 dm-sans-medium text-lg mr-2"},T={class:"italic text-gray-400 dm-sans-regular mt-2"},Z=["onClick"],M={key:1,class:"flex justify-center items-center w-full h-full basis-1/5 bg-ui-stone ring-ui-ring rounded-tr-md rounded-br-md ring-2"},K={class:"text-ui-primary text-2xl dm-sans-medium"};class p{constructor(e,l,n,d,y,w,x,_){this.addedOn=e,this.canPlay=l,this.id=n,this.url=d,this.playedAlready=y,this.title=w,this.uuid=x,this.votes=_}}const z={data(){return{uuid:null,records:[],viewportHeight:window.innerHeight}},async mounted(){localStorage.getItem("uuid")==null?(this.uuid=S(),localStorage.setItem("uuid",this.uuid)):this.uuid=localStorage.getItem("uuid"),document.addEventListener("keydown",this.handleKeyDown),this.$refs.sendButton.addEventListener("click",this.sendRequest);let t=this.viewportHeight-this.$refs.titleHeader.clientHeight-this.$refs.inputHeader.clientHeight;this.$refs.songsList.style.maxHeight=`${t}px`,this.getSongs()},beforeUnmount(){document.removeEventListener("keydown",this.handleKeyDown),this.$refs.sendButton.removeEventListener("click",this.sendRequest)},methods:{async sendPostRequest(t){await c.post("http://localhost:3000/db.php",{message:t}).then(e=>{console.log(e.data)}).catch(e=>{console.error("Error:",e)})},async sendRequest(){let t=new Date,e=t.toISOString().slice(0,10),l=t.toTimeString().slice(0,8),n=`${e} ${l}`,d=this.$refs.songInput.value;await this.sendPostRequest(`add:${d}|||null|||${this.uuid}|||0|||${n}|||0|||1`),this.$refs.songInput.value="",await this.getSongs()},async getSongs(){let t;await c.get("https://spdisco.hu/db.php").then(e=>{t=e.data}).catch(e=>{console.error("Error:",e)}),t.forEach(e=>{this.records.push(new p(e.AddedOn,e.CanPlay,e.ID,e.Link,e.PlayedAlready,e.Title,e.Uuid,e.Votes))}),this.records=t.map(e=>new p(e.AddedOn,e.CanPlay,e.ID,e.Link,e.PlayedAlready,e.Title,e.Uuid,e.Votes)),this.records.sort((e,l)=>new Date(l.addedOn)-new Date(e.addedOn))},handleKeyDown(t){t.keyCode===13&&this.sendRequest()},async handleUpvote(t){await this.sendPostRequest(`upvote:${t}|||${this.uuid}`),await this.getSongs()}}},G=Object.assign(z,{__name:"MusicView",setup(t){return(e,l)=>(a(),o("div",I,[i("div",R,L,512),i("div",V,[i("input",E,null,512),i("button",q,[h(g(b),{class:"h-7 w-7 stroke-white fill-ui-card stroke-2"})],512)],512),i("div",A,[(a(!0),o(f,null,v(e.records,n=>(a(),o("div",B,[i("div",C,[i("div",O,[i("h3",P,u(n.title),1)]),i("h3",T," Érkezett: "+u(n.addedOn.split(" ")[1].substring(0,5)),1)]),n.uuid.includes(e.uuid)?(a(),o("div",M,[i("h3",K,u(n.votes),1)])):(a(),o("div",{key:0,onClick:d=>e.handleUpvote(n.id),class:"flex justify-center items-center w-full h-full basis-1/5 bg-ui-stone ring-ui-ring rounded-tr-md rounded-br-md ring-2 cursor-pointer active:bg-stone-950"},[h(g(k),{class:"fill-white size-10"})],8,Z))]))),256))],512)]))}});export{G as default};
